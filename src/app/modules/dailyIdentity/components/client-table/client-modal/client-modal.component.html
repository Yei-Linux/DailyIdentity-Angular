<div nz-col>
  <div class="">
    <div>
      <form nz-form [formGroup]="clientForm" class="cardCustomer">
        <nz-steps [nzCurrent]="currentStepIndex" style="background: black;">
          <nz-step></nz-step>
          <nz-step></nz-step>
          <nz-step></nz-step>
          <nz-step></nz-step>
        </nz-steps>

        <div class="steps-content stepClass">
          <div *ngIf="currentStepIndex == 0">
            <nz-form-item>
              <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="email" 
                >Client Id</nz-form-label
              >
              <nz-form-control [nzSm]="14" [nzXs]="24" nzHasFeedback nzErrorTip="Empty ClientId">
                <input nz-input formControlName="clientId" id="clientId" />
              </nz-form-control>
            </nz-form-item>

            <nz-form-item>
              <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="email"
                >Description</nz-form-label
              >
              <nz-form-control [nzSm]="14" [nzXs]="24" nzHasFeedback nzErrorTip="Empty Description">
                <input nz-input formControlName="description" id="description" />
              </nz-form-control>
            </nz-form-item>

            <nz-form-item>
              <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="email"
                >Resource Ids</nz-form-label
              >
              <nz-form-control [nzSm]="14" [nzXs]="24"  nzHasFeedback nzErrorTip="Empty ResourceId">
                <nz-select
                  nzMode="multiple"
                  nzPlaceHolder="Please select resourceId"
                  formControlName="resourceIds"
                >
                  <nz-option
                    *ngFor="let resourceIdOption of resourcesIdsOptions"
                    [nzLabel]="resourceIdOption"
                    [nzValue]="resourceIdOption"
                  ></nz-option>
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </div>

          <div *ngIf="currentStepIndex == 1">
            <nz-form-item *ngIf="isEdit">
              <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="email"
                >Client Secret</nz-form-label
              >
              <nz-form-control
                nzExtra="Select and send to change secret"
              >
                <button
                  class="ml-2"
                  nz-button
                  nzType="primary"
                  nzShape="round"
                  (click)="sendNotification('EMAIL')"
                >
                  <i nz-icon nzType="google-plus" nzTheme="outline"></i>Email
                </button>
                <button
                  class="ml-2"
                  nz-button
                  nzType="primary"
                  nzShape="round"
                  (click)="sendNotification('SMS')"
                >
                  <i nz-icon nzType="message" nzTheme="outline"></i>SMS
                </button>
              </nz-form-control>
            </nz-form-item>

            <nz-form-item *ngIf="!isEdit">
              <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="email"
                >Client Secret</nz-form-label
              >
              <nz-form-control [nzSm]="14" [nzXs]="24" nzHasFeedback nzErrorTip="Empty Client Secret">
                  <nz-input-group nzPrefixIcon="lock" [nzSuffix]="suffixTemplatePassword">
                      <input [type]="passwordVisible ? 'text' : 'password'" 
                      nz-input placeHolder="Please input client secret" formControlName="clientSecret" id="secret" />
                  </nz-input-group>
              </nz-form-control>
            </nz-form-item>

            <nz-form-item>
              <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="email"
                >Scope</nz-form-label
              >
              <nz-form-control [nzSm]="14" [nzXs]="24" nzHasFeedback nzErrorTip="Empty Scope">
                <nz-select
                  nzMode="multiple"
                  nzPlaceHolder="Please select scope"
                  formControlName="scope"
                >
                  <nz-option
                    *ngFor="let scopeOption of scopeOptions"
                    [nzLabel]="scopeOption"
                    [nzValue]="scopeOption"
                  ></nz-option>
                </nz-select>
              </nz-form-control>
            </nz-form-item>

            <nz-form-item>
              <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="email"
                >Grants</nz-form-label
              >
              <nz-form-control [nzSm]="14" [nzXs]="24" nzHasFeedback nzErrorTip="Empty Grants">
                <nz-select
                  nzMode="multiple"
                  nzPlaceHolder="Please select grant"
                  formControlName="grantTypes"
                >
                  <nz-option
                    *ngFor="let grantsOption of grantsOptions"
                    [nzLabel]="grantsOption"
                    [nzValue]="grantsOption"
                  ></nz-option>
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </div>

          <div *ngIf="currentStepIndex == 2">
            <nz-form-item>
              <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="email"
                >Redirect URI</nz-form-label
              >
              <nz-form-control [nzSm]="14" [nzXs]="24">
                <input nz-input formControlName="redirectUri" id="uri" />
              </nz-form-control>
            </nz-form-item>

            <nz-form-item>
              <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="email"
                >Authorities</nz-form-label
              >
              <nz-form-control [nzSm]="14" [nzXs]="24">
                <input nz-input formControlName="authorities" id="authorities" />
              </nz-form-control>
            </nz-form-item>

            <nz-form-item>
              <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="email"
                >Acces token</nz-form-label
              >
              <nz-form-control [nzSm]="14" [nzXs]="24" nzHasFeedback nzErrorTip="Empty Time">
                <nz-input-number
                  formControlName="accessTokenTime"
                  [nzStep]="1"
                ></nz-input-number>
              </nz-form-control>
            </nz-form-item>
          </div>

          <div *ngIf="currentStepIndex == 3">
            <nz-form-item>
              <nz-form-label [nzSm]="8" [nzXs]="26" nzRequired nzFor="email"
                >Refresh Token</nz-form-label
              >
              <nz-form-control [nzSm]="14" [nzXs]="24" nzHasFeedback nzErrorTip="Empty Time">
                <nz-input-number
                  formControlName="refreshTokenTime"
                  [nzStep]="1"
                ></nz-input-number>
              </nz-form-control>
            </nz-form-item>

            <nz-form-item>
              <nz-form-label [nzSm]="8" [nzXs]="26" nzRequired nzFor="email"
                >Additional Info.</nz-form-label
              >
              <nz-form-control [nzSm]="14" [nzXs]="24">
                <button
                  class="ml-2"
                  nz-button
                  nzType="primary"
                  [nzSize]="size"
                  nzShape="round"
                  (click)="openDrawer()"
                >
                  <i nz-icon nzType="smile" nzTheme="outline"></i>Open Drawer
                </button>
              </nz-form-control>
            </nz-form-item>

            <nz-form-item>
              <nz-form-label [nzSm]="8" [nzXs]="26" nzRequired nzFor="email"
                >Autoapprove</nz-form-label
              >
              <nz-form-control [nzSm]="14" [nzXs]="24">
                <input nz-input formControlName="autoapprove" id="autoapprove" />
              </nz-form-control>
            </nz-form-item>
          </div>
        </div>
      </form>
    </div>

    <div
      style="display: flex;justify-content: space-between;justify-items: flex-end;"
      class="steps-action"
    >
      <button
        nz-button
        nzType="default"
        (click)="goBack()"
        *ngIf="currentStepIndex > 0"
      >
        <span>Previous</span>
      </button>
      <button
        nz-button
        nzType="default"
        (click)="next()"
        *ngIf="currentStepIndex < 3"
      >
        <span>Next</span>
      </button>
      <button
        nz-button
        nzType="primary"
        *ngIf="currentStepIndex === 3"
        [nzLoading]="isLoadingClient"
        (click)="isEdit ? updateClient() : createClient()"
      >
        <span>{{ title }}</span>
      </button>
    </div>
  </div>
</div>

<app-drawer-additional-information
  [(visible)]="visible"
  (closeEmitter)="closeDrawer($event)"
  [(additionalInformation)]="additionalInformationClient"
  (updateField)="updateAdditionalField($event)"
></app-drawer-additional-information>

<ng-template #suffixTemplatePassword>
    <i
      nz-icon
      [nzType]="passwordVisible ? 'eye-invisible' : 'eye'"
      (click)="passwordVisible = !passwordVisible"
    ></i>
</ng-template>
